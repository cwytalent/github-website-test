name: Test Website Access

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    
    steps:
    - name: Step 1 - Checkout code
      uses: actions/checkout@v3
    
    - name: Step 2 - Show GitHub IP
      run: |
        echo "GitHub Runner Information:"
        echo "=========================="
        echo "Public IP: $(curl -s ifconfig.me)"
        echo "Test Time: $(date)"
        echo ""
    
    - name: Step 3 - Test First Website
      run: |
        echo "Testing: https://epg.51zmt.top:8001"
        echo "----------------------------------"
        if curl -k -s --max-time 30 "https://epg.51zmt.top:8001" > /dev/null; then
          echo "✅ Website 1 is accessible"
          curl -k -s -o /dev/null -w "Status Code: %{http_code}\nResponse Time: %{time_total}s\n" --max-time 30 "https://epg.51zmt.top:8001"
        else
          echo "❌ Website 1 is NOT accessible"
        fi
        echo ""
    
    - name: Step 4 - Test Second Website
      run: |
        echo "Testing: https://epg.51zmt.top:8001/sctvmulticast.html"
        echo "------------------------------------------------------"
        if curl -k -s --max-time 30 "https://epg.51zmt.top:8001/sctvmulticast.html" > /dev/null; then
          echo "✅ Website 2 is accessible"
          curl -k -s -o /dev/null -w "Status Code: %{http_code}\nResponse Time: %{time_total}s\n" --max-time 30 "https://epg.51zmt.top:8001/sctvmulticast.html"
        else
          echo "❌ Website 2 is NOT accessible"
        fi
        echo ""
    
    - name: Step 5 - Test Summary
      run: |
        echo "Test Summary:"
        echo "============="
        echo "Completed at: $(date)"
        echo "GitHub Runner IP: $(curl -s ifconfig.me)"